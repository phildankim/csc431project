#!/bin/bash

make clean;make

# exit when any command fails
set -e

for dir in benchmarks/*; do
   f=${dir##*/}
   echo $f
   java MiniCompiler $dir/${f}.mini -stack
   clang $dir/${f}.ll -m32
   ./a.out < $dir/input > ${f}.txt
   echo 'diffing'
   diff ${f}.txt $dir/output
   echo 'diffing complete'
done
